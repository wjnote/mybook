# web安全问题

### 跨站脚本攻击（xss）的防御
跨站脚本攻击（XSS，Cross-site scription） 是最常见和最基本的攻击web网站的方法，攻击者可以在网页上发布包含攻击性代码的数据，当浏览者看到此网页的时候，特定的脚本就会以浏览用户的身份和权限来执行，通过XSS可以比较容易的修改用户数据，窃取用户信息和其他类型的攻击(例如：CSRF攻击)

除了在页面模版中存在XSS攻击，在web其他的几个途径也可能存在风险
1. 一个页面如果找不到的，系统会报404 not found 错误，
```shell
404 NotFound
Page /page/not/found does not exsit
```
这个时候如果攻击者构建一个类似的连接 `http://localhost/%3Cscript%3Ealert%28%27hello%27%29%3C%2Fscript%3E` 并引诱用户点击，其中的 `<script>alert('hello')</script>` 就会被执行。

解决办法：
1. 防止XSS攻击的方式就是对用户输入的数据进行转义
2. 如果页面是让用户输入富文本文件(比如浏览版，论坛可以让用户设置字体颜色背景等)，所以富文本是有代码的，这个时候就需要过滤用户输入的 script 标签，请求连接，和特殊的属性
3. 如果是用户输入的信息都需要进行转义，


### 跨站请求伪造（CSRF）
跨站请求伪造是另一种常见的攻击，攻击者通过各种方法伪造一个请求，模仿用户提交表单的行为，从而达到修改用户数据或执行特定的目的。包括A标签，ajax提交数据，form表单等都是请求。

为了假冒用户的身份，CSRF 攻击常常和 XSS 攻击配合使用，但也可以通过其他的方式：例如诱使用户点击一个包含攻击的连接

解决办法：
1. 增加攻击的难度，GET请求是比较容易创建的，但是POST请求就需要借助 JS 才能实现，所以可以让服务器只接受 post 方式，增加系统安全性
2. 对请求进行认证，确保该请求是用户本人填写表单提交的，而不是伪造的，流程如下

```shell
(一个正常用户提交表单的流程)
用户请求修改信息 =>  网站显示用户修改信息的表单 => 用户修改信息并提交 =>  网站接受用户信息并保存

(一个CSRF的流程)
直接跳到第二部 =>  伪造要修改的信息并提交 =>  网站接受伪造的数据并保存

(对第二部所提交的表单进行验证就可以确保是用户提交的)
用户请求修改信息 => 网站显示一个空白的修改信息表单，表单中保存特殊的Token，并把Token保存在session中 =>  用户提交信息并将Token传到服务端 =>  网站对比Token的值，一致则是用户提交的请求
```
> 如果是攻击者伪造的请求，是没办法访问到session的，所以也拿不到实际的Token值


### HTTP Header 安全
CRLF injection 攻击者想办法在响应头中注入两个 CRLF 特殊字符，导致响应数据格式异常，从而注入script等

拒绝访问攻击： 每个请求都会携带cookie，而服务器一般都会限制 cookie 的大小，所以如果用户的cookie被设置成了超过某个阀值，那么用户就再也无法访问到网站

cookie 防窃取，cookie 窃取都是通过js（XSS漏洞）获取的，所以尽量将cookie设置为 `http only` 并且加上过期时间